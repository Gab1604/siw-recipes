<!DOCTYPE html>
<html lang="it"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/springsecurity6">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aggiungi Libro | SiwBooks</title>
</head>
<body>
<div th:replace="~{base :: content}">
  <h1>Aggiungi un nuovo Libro</h1>

  <!-- Errori di validazione -->
  <div th:if="${#fields.hasErrors('*')}" class="message error">
    <p>Ci sono errori nei campi evidenziati. Controlla e riprova.</p>
  </div>

  <!-- Form di inserimento -->
  <form th:action="@{/books/add}" th:object="${book}" method="post" enctype="multipart/form-data">

    <div class="form-group">
      <label for="title">Titolo</label>
      <input type="text" id="title" th:field="*{title}" placeholder="Titolo" required />
      <p th:if="${#fields.hasErrors('title')}" th:errors="*{title}" class="field-error">Errore titolo</p>
    </div>

    <div class="form-group">
      <label for="publicationYear">Anno di Pubblicazione</label>
      <input type="number" id="publicationYear" th:field="*{publicationYear}" min="0" required />
      <p th:if="${#fields.hasErrors('publicationYear')}" th:errors="*{publicationYear}" class="field-error">Errore anno</p>
    </div>

    <div class="form-group">
      <label for="synopsis">Sinossi</label>
      <textarea id="synopsis" rows="4" th:field="*{synopsis}" placeholder="Scrivi una breve sinossi..."></textarea>
    </div>

    <div class="form-group">
      <label for="imageFile">Copertina (immagine)</label>
      <input type="file" id="imageFile" name="imageFile" accept="image/*" />
    </div>

    <div class="form-group">
      <label for="authors">Autori</label>
      <select id="authors" name="authorIds" multiple>
        <option th:each="author : ${authors}"
                th:value="${author.id}"
                th:text="${author.firstName + ' ' + author.lastName}">
        </option>
      </select>
    </div>

    <div class="button-group">
      <button type="submit" class="btn">Salva Libro</button>
      <a th:href="@{/books}" class="btn">Annulla</a>
    </div>

  </form>
</div>
</body>
</html>
