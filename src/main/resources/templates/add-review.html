<!DOCTYPE html>
<html lang="it"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/springsecurity6">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Scrivi Recensione | SiwBooks</title>
</head>
<body>
  <!-- Estende il layout base -->
  <div th:replace="~{base :: content}">
    <h1>Scrivi una recensione per "<span th:text="${book.title}">Titolo Libro</span>"</h1>

    <!-- Messaggi di errore generali -->
    <div th:if="${#fields.hasErrors('*')}" class="message error">
      Ci sono errori nei campi evidenziati. Controlla e riprova.
    </div>

    <form th:action="@{/books/{id}/review(id=${book.id})}"
          th:object="${review}"
          method="post">
      <div class="form-group">
        <label for="rating">Voto (1â€“5)</label>
        <input id="rating"
               type="number"
               min="1"
               max="5"
               th:field="*{rating}"
               required />
        <p class="field-error"
           th:if="${#fields.hasErrors('rating')}"
           th:errors="*{rating}">Voto non valido</p>
      </div>

      <div class="form-group">
        <label for="text">Testo della recensione</label>
        <textarea id="text"
                  rows="5"
                  th:field="*{text}"
                  placeholder="Scrivi qui la tua recensione..."
                  required></textarea>
        <p class="field-error"
           th:if="${#fields.hasErrors('text')}"
           th:errors="*{text}">Testo obbligatorio</p>
      </div>

      <div class="button-group">
        <button type="submit" class="btn">Pubblica</button>
        <a th:href="@{/books/{id}(id=${book.id})}" class="btn">Annulla</a>
      </div>
    </form>
  </div>
</body>
</html>
