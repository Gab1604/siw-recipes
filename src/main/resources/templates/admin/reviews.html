<!DOCTYPE html>
<html lang="it" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{base :: head}"></head>
<body>
<header th:replace="~{base :: header}"></header>

<main class="content">
  <section class="admin-section">
    <h2>Gestione Recensioni</h2>

    <div th:if="${#lists.isEmpty(reviews)}" class="empty-state">
      <p>Nessuna recensione presente al momento.</p>
    </div>

    <div th:if="${!#lists.isEmpty(reviews)}">
      <table class="table striped hover">
        <thead>
          <tr>
            <th>ID</th>
            <th>Libro</th>
            <th>Utente</th>
            <th>Voto</th>
            <th>Testo</th>
            <th>Data</th>
            <th>Azioni</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="review : ${reviews}">
            <td th:text="${review.id}">1</td>
            <td>
              <a th:href="@{/books/{id}(id=${review.book.id})}" th:text="${review.book.title}">Libro</a>
            </td>
            <td th:text="${review.user.username}">utente</td>
            <td>
              <span class="badge" th:text="${review.rating} + '/5'">5/5</span>
            </td>
            <td th:text="${review.text}">Testo recensione…</td>
            <td th:text="${#dates.format(review.createdAt, 'dd/MM/yyyy')}">01/01/2025</td>
            <td>
              <form th:action="@{/admin/reviews/delete/{id}(id=${review.id})}" method="post" style="display:inline">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="btn danger small">Elimina</button>
              </form>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="mt-3">
      <a th:href="@{/admin}" class="btn">← Torna alla Dashboard</a>
    </div>
  </section>
</main>

<footer th:replace="~{base :: footer}"></footer>
</body>
</html>
